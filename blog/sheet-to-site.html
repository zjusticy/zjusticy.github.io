<!DOCTYPE html><html><head><link rel="icon" type="image/png" href="/favicon.png"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-164183122-1"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-164183122-1', {
              page_path: window.location.pathname,
            });
          </script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Use google sheets as a content management system (CMS) for an eCommerce site</title><meta name="description" content="Use google sheets as a content management system (CMS) for an eCommerce site"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/efcb24a90b33747b7582.css" as="style"/><link rel="stylesheet" href="/_next/static/css/efcb24a90b33747b7582.css" data-n-g=""/><link rel="preload" href="/_next/static/css/cbaae6e608cab26eeba6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cbaae6e608cab26eeba6.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-ddb8120628696eab2cf7.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.37f4a736348214b3ca94.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.cd0284e737cdbe1a0804.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-d10701d77946164edce8.js" as="script"/><link rel="preload" href="/_next/static/chunks/cb1608f2.a8b8abb6f1565b60835e.js" as="script"/><link rel="preload" href="/_next/static/chunks/275aa556a5034f679288ea31c9ede8d484e91f4a.a637e2ef2f3c7f61e3fc.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bslug%5D-19f79f3dcf5c2cff4cd1.js" as="script"/></head><body><div id="__next"><div><nav class="layout_navbar__1zC8E" role="navigation" aria-label="main navigation"><div class="container"><div class="layout_navbarBrand__37nmK"><a class="layout_navbarItem__1LSrv" href="/"><svg width="36" height="36" viewBox="0 0 144 142" aria-hidden="true" fill="#000" class="svg-icon " xmlns="http://www.w3.org/2000/svg"><rect x="124" y="81" width="20" height="20" fill="black"></rect><rect x="124" y="102" width="20" height="20" fill="black"></rect><rect x="41" y="20" width="20" height="20" fill="black"></rect><rect x="83" y="20" width="20" height="20" fill="black"></rect><rect x="62" y="122" width="20" height="20" fill="black"></rect><rect x="124" y="60" width="20" height="20" fill="black"></rect><rect y="81" width="20" height="20" fill="black"></rect><rect y="102" width="20" height="20" fill="black"></rect><rect x="62" width="20" height="20" fill="black"></rect><rect x="41" y="122" width="20" height="20" fill="black"></rect><rect x="104" y="122" width="20" height="20" fill="black"></rect><rect x="104" y="40" width="20" height="20" fill="black"></rect><rect x="83" y="122" width="20" height="20" fill="black"></rect><rect x="20" y="40" width="20" height="20" fill="black"></rect><rect x="20" y="122" width="20" height="20" fill="black"></rect><rect y="60" width="20" height="20" fill="black"></rect></svg></a><a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample"><span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span></a></div><div id="navbarBasicExample" class="layout_navbarMenu__1NXMa"><div class="layout_navEndSettings__227S4 layout_navbarEnd__3jMCV"><a class="layout_navbarItem__1LSrv layout_moreMargin__2KGfE layout_nonBorder__OGLUi" aria-label="Home page" href="/">Home</a><a class="layout_navbarItem__1LSrv layout_moreMargin__2KGfE layout_addBorder__2Y_EI" aria-label="Blog page" href="/blog">Blog</a><a class="layout_navbarItem__1LSrv layout_moreMargin__2KGfE layout_nonBorder__OGLUi" aria-label="About the author" href="/about">About</a></div></div></div></nav><main><div class="isBlog"><nav class="breadcrumb is-medium" aria-label="breadcrumbs"><ul><li><a href="/blog">Blog</a></li><li class="is-active"><span></span></li></ul></nav><article><h1 class="isBlog-title is-2p5">Use google sheets as a content management system (CMS) for an eCommerce site</h1><span class="dateStyle-2">10 Apr, 2021</span><div class="content"><div><p><img src="/sheetExample.png" alt="Google sheet page"></p>
<p><strong><a href="https://next-shopping-cart.vercel.app">DEMO</a></strong></p>
<p>The previous blog:  <a href="https://zjusticy.github.io/blog/next-react-shopping-cart">next-shopping-cart</a></p>
<p>You can check the code of this project on <a href="https://github.com/zjusticy/next-shopping-cart">Github</a>.</p>
<p>Google Sheets have some great advantage as a content management system.</p>
<ul>
<li>It is easy for people to get started and the cost of learning is extremely low</li>
<li>Build-in collaboration support</li>
</ul>
<p>Cons:</p>
<ul>
<li>There are <a href="https://developers.google.com/sheets/api/limits">usage limits</a> for the Google Sheets API.</li>
<li>It is not a proper database if your business keeps growing. However, it is still capable of connecting Google Sheets with other headless CMSs.</li>
</ul>
<p>Here is an example of using Google Sheets for an eCommerce site.</p>
<p><a href="https://docs.google.com/spreadsheets/d/1UsOkG1kRY6Qb50F76v-msb18-mvXxvX-0CmcAtv_aoA/edit?usp=sharing">Google Sheets Example</a></p>
<p>For a small site, it is easy to maintain and update by using Google Sheets. Also, we can use Google App Script to select the data and output it to other platforms. In Google App Script, we have to first implement a <strong>doGet()</strong> function as a response to an HTTP get request. From the sheets’ URL and page name, we can reach the data we need. The code below can explain itself.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span>  <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span>  <span class="token constant">SPREADSHEET_URL</span> <span class="token operator">=</span> <span class="token string">"Google Sheets' URL"</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span>  <span class="token constant">SHEET_NAME_ONE</span> <span class="token operator">=</span> <span class="token string">"Sheets' name"</span><span class="token punctuation">;</span>

  <span class="token comment">// Get the sheets by name</span>
  <span class="token keyword">var</span>  ss <span class="token operator">=</span> <span class="token maybe-class-name">SpreadsheetApp</span><span class="token punctuation">.</span><span class="token method function property-access">openByUrl</span><span class="token punctuation">(</span><span class="token constant">SPREADSHEET_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Get the certain sheet by name</span>
  <span class="token keyword">var</span>  sheet <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token method function property-access">getSheetByName</span><span class="token punctuation">(</span><span class="token constant">SHEET_NAME_ONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span>  jo <span class="token operator">=</span> <span class="token function">getItems</span><span class="token punctuation">(</span>sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Stringify and output the data</span>
  <span class="token keyword">var</span>  result <span class="token operator">=</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>jo<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span>  <span class="token maybe-class-name">ContentService</span><span class="token punctuation">.</span><span class="token method function property-access">createTextOutput</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">setMimeType</span><span class="token punctuation">(</span><span class="token maybe-class-name">ContentService</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">MimeType</span></span><span class="token punctuation">.</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span>  <span class="token function">getItems</span><span class="token punctuation">(</span><span class="token parameter">sheet</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span>  dataArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Collect data from the 2nd row to the last row vertically,</span>
<span class="token comment">// and from the first column to the last column horizontally for each row</span>
  <span class="token keyword">var</span>  rows <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getLastColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">getValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// For the equation use getFormulas instead of getValues</span>
  <span class="token keyword">var</span>  urls <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">getFormulas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Go through all the rows to put data into an array</span>

  <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span>  i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> rows<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">&#x3C;</span>j<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span>  dataRow <span class="token operator">=</span> rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span>  record <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    record<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRow<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    record<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRow<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    record<span class="token punctuation">[</span><span class="token string">'unit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRow<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    record<span class="token punctuation">[</span><span class="token string">'price'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRow<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Extract the URL data using regular expression</span>
    record<span class="token punctuation">[</span><span class="token string">'image'</span><span class="token punctuation">]</span> <span class="token operator">=</span> urls<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">=image\("(.*)"</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    record<span class="token punctuation">[</span><span class="token string">'categary'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRow<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    dataArray<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span>  dataArray<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Then save the file --> click deploy --> new deploy --> select type ( web application) --> select anyone can access the application --> deploy. We can check the result from an API testing tool online.</p>
<p><img src="/apiTest.png" alt="Screen Shot 2021-02-16 at 10.00.37 PM"></p>
<p>This is really useful for some showcase websites.</p>
<h2>Reference</h2>
<p><a href="https://medium.com/%E9%87%8E%E8%96%91%E9%96%8B%E6%A5%AD%E6%97%A5%E8%A8%98/%E9%81%8B%E7%94%A8-google-sheet-%E8%A3%BD%E4%BD%9C%E7%B0%A1%E6%98%93%E7%9A%84-cms-b5b2a99b101e">Simple site from Goole Sheets</a></p></div></div></article><div class="marginTop-2"><a>← Blog</a></div></div></main><footer class="layout_myFooter__JubIR"><div class="container"><div>Email me:     <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg> <a href="mailto:tzhu618@gmail.com">tzhu618@gmail.com</a></div><div class="layout_lastColor__ALfcM">© <!-- -->2021<!-- -->, Built with<!-- --> <a href="https://nextjs.org/">NextJs</a> and <a href="https://getbase.org">Base</a></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"Use google sheets as a content management system (CMS) for an eCommerce site","date":"2021-02-10T09:40:32.169Z","description":"Use google sheets as a content management system (CMS) for an eCommerce site","slug":"sheet-to-site","content":"\u003cp\u003e\u003cimg src=\"/sheetExample.png\" alt=\"Google sheet page\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"https://next-shopping-cart.vercel.app\"\u003eDEMO\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eThe previous blog:  \u003ca href=\"https://zjusticy.github.io/blog/next-react-shopping-cart\"\u003enext-shopping-cart\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eYou can check the code of this project on \u003ca href=\"https://github.com/zjusticy/next-shopping-cart\"\u003eGithub\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eGoogle Sheets have some great advantage as a content management system.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIt is easy for people to get started and the cost of learning is extremely low\u003c/li\u003e\n\u003cli\u003eBuild-in collaboration support\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCons:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThere are \u003ca href=\"https://developers.google.com/sheets/api/limits\"\u003eusage limits\u003c/a\u003e for the Google Sheets API.\u003c/li\u003e\n\u003cli\u003eIt is not a proper database if your business keeps growing. However, it is still capable of connecting Google Sheets with other headless CMSs.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eHere is an example of using Google Sheets for an eCommerce site.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.google.com/spreadsheets/d/1UsOkG1kRY6Qb50F76v-msb18-mvXxvX-0CmcAtv_aoA/edit?usp=sharing\"\u003eGoogle Sheets Example\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFor a small site, it is easy to maintain and update by using Google Sheets. Also, we can use Google App Script to select the data and output it to other platforms. In Google App Script, we have to first implement a \u003cstrong\u003edoGet()\u003c/strong\u003e function as a response to an HTTP get request. From the sheets’ URL and page name, we can reach the data we need. The code below can explain itself.\u003c/p\u003e\n\u003cpre class=\"language-js\"\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e  \u003cspan class=\"token function\"\u003edoGet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  \u003cspan class=\"token constant\"\u003eSPREADSHEET_URL\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Google Sheets' URL\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  \u003cspan class=\"token constant\"\u003eSHEET_NAME_ONE\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Sheets' name\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"token comment\"\u003e// Get the sheets by name\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  ss \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eSpreadsheetApp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eopenByUrl\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token constant\"\u003eSPREADSHEET_URL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token comment\"\u003e// Get the certain sheet by name\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  sheet \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e ss\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetSheetByName\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token constant\"\u003eSHEET_NAME_ONE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  jo \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003egetItems\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003esheet\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"token comment\"\u003e// Stringify and output the data\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eJSON\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003estringify\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ejo\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e  \u003cspan class=\"token maybe-class-name\"\u003eContentService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ecreateTextOutput\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003esetMimeType\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eContentService\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eMimeType\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token known-class-name class-name\"\u003eJSON\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e  \u003cspan class=\"token function\"\u003egetItems\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003esheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  dataArray \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Collect data from the 2nd row to the last row vertically,\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// and from the first column to the last column horizontally for each row\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  rows \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sheet\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetRange\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sheet\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetLastRow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sheet\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetLastColumn\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetValues\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// For the equation use getFormulas instead of getValues\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  urls \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sheet\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetRange\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sheet\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetLastRow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003egetFormulas\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// Go through all the rows to put data into an array\u003c/span\u003e\n\n  \u003cspan class=\"token keyword control-flow\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  i\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e j \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e rows\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elength\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003ej\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  dataRow \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e rows\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e  record \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    record\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'id'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e dataRow\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etoString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    record\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'name'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e dataRow\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    record\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'unit'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e dataRow\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    record\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'price'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e dataRow\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003etoString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// Extract the URL data using regular expression\u003c/span\u003e\n    record\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'image'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e urls\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ematch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-source language-regex\"\u003e=image\\(\"(.*)\"\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-flags\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    record\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'categary'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e dataRow\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    dataArray\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003epush\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erecord\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e  dataArray\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen save the file --\u003e click deploy --\u003e new deploy --\u003e select type ( web application) --\u003e select anyone can access the application --\u003e deploy. We can check the result from an API testing tool online.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/apiTest.png\" alt=\"Screen Shot 2021-02-16 at 10.00.37 PM\"\u003e\u003c/p\u003e\n\u003cp\u003eThis is really useful for some showcase websites.\u003c/p\u003e\n\u003ch2\u003eReference\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://medium.com/%E9%87%8E%E8%96%91%E9%96%8B%E6%A5%AD%E6%97%A5%E8%A8%98/%E9%81%8B%E7%94%A8-google-sheet-%E8%A3%BD%E4%BD%9C%E7%B0%A1%E6%98%93%E7%9A%84-cms-b5b2a99b101e\"\u003eSimple site from Goole Sheets\u003c/a\u003e\u003c/p\u003e"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"sheet-to-site"},"buildId":"Lt_0jgAm4B_BfSfe89iiA","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-feb8a7604fa7fce626b2.js"></script><script src="/_next/static/chunks/main-ddb8120628696eab2cf7.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.37f4a736348214b3ca94.js" async=""></script><script src="/_next/static/chunks/commons.cd0284e737cdbe1a0804.js" async=""></script><script src="/_next/static/chunks/pages/_app-d10701d77946164edce8.js" async=""></script><script src="/_next/static/chunks/cb1608f2.a8b8abb6f1565b60835e.js" async=""></script><script src="/_next/static/chunks/275aa556a5034f679288ea31c9ede8d484e91f4a.a637e2ef2f3c7f61e3fc.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-19f79f3dcf5c2cff4cd1.js" async=""></script><script src="/_next/static/Lt_0jgAm4B_BfSfe89iiA/_buildManifest.js" async=""></script><script src="/_next/static/Lt_0jgAm4B_BfSfe89iiA/_ssgManifest.js" async=""></script></body></html>
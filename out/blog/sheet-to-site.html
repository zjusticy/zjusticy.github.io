<!DOCTYPE html><html><head><link rel="icon" type="image/png" href="/favicon.png"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-164183122-1"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-164183122-1', {
              page_path: window.location.pathname,
            });
          </script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;display=swap"/><title>Use google sheets as a content management system (CMS) for an eCommerce site</title><meta name="description" content="Use google sheets as a content management system (CMS) for an eCommerce site"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/247593301584cfcb2949.css" as="style"/><link rel="stylesheet" href="/_next/static/css/247593301584cfcb2949.css"/><link rel="preload" href="/_next/static/css/f26d4875aca2643082fa.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f26d4875aca2643082fa.css"/><link rel="preload" href="/_next/static/OyX9zXWnaKsF3bwITkPiy/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/OyX9zXWnaKsF3bwITkPiy/pages/blog/%5Bslug%5D.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.126679bf45d7d49475d8.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.034e57c59893763d3595.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-d7ebbd1d8dc934d86683.js" as="script"/><link rel="preload" href="/_next/static/chunks/cb1608f2.3c307e8bab2014a7f3fb.js" as="script"/><link rel="preload" href="/_next/static/chunks/b5f2ed29.a17aa8175ac69602f508.js" as="script"/><link rel="preload" href="/_next/static/chunks/02a29bc1c6847a2903810fa698c0853380643ebd.eb7f86bcbbf58571f3fc.js" as="script"/><link rel="preload" href="/_next/static/chunks/411cb42639decf701111c98274b23dedc6e87d14.7504d1c9a7d74be7afa0.js" as="script"/></head><body><div id="__next"><div><nav class="navbar has-shadow" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><a class="navbar-item" href="/"><svg width="36" height="36" viewBox="0 0 144 142" aria-hidden="true" fill="#000" class="svg-icon " xmlns="http://www.w3.org/2000/svg"><rect x="124" y="81" width="20" height="20" fill="black"></rect><rect x="124" y="102" width="20" height="20" fill="black"></rect><rect x="41" y="20" width="20" height="20" fill="black"></rect><rect x="83" y="20" width="20" height="20" fill="black"></rect><rect x="62" y="122" width="20" height="20" fill="black"></rect><rect x="124" y="60" width="20" height="20" fill="black"></rect><rect y="81" width="20" height="20" fill="black"></rect><rect y="102" width="20" height="20" fill="black"></rect><rect x="62" width="20" height="20" fill="black"></rect><rect x="41" y="122" width="20" height="20" fill="black"></rect><rect x="104" y="122" width="20" height="20" fill="black"></rect><rect x="104" y="40" width="20" height="20" fill="black"></rect><rect x="83" y="122" width="20" height="20" fill="black"></rect><rect x="20" y="40" width="20" height="20" fill="black"></rect><rect x="20" y="122" width="20" height="20" fill="black"></rect><rect y="60" width="20" height="20" fill="black"></rect></svg></a><a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample"><span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span></a></div><div id="navbarBasicExample" class="navbar-menu"><div class="layout_navEndSettings__227S4 navbar-end"><a class="navbar-item layout_moreMargin__2KGfE" aria-label="Home page" href="/">Home</a><a class="navbar-item layout_moreMargin__2KGfE layout_addBorder__2Y_EI" aria-label="Blog page" href="/blog">Blog</a><a class="navbar-item layout_moreMargin__2KGfE" aria-label="About the author" href="/about">About</a></div></div></div></nav><main><div class="isBlog"><nav class="breadcrumb is-medium" aria-label="breadcrumbs"><ul><li><a href="/blog">Blog</a></li><li class="is-active"><span></span></li></ul></nav><article><h1 class="title is-2p5">Use google sheets as a content management system (CMS) for an eCommerce site</h1><span class="dateStyle-2">10 Apr, 2021</span><div class="content"><div><p><img src="/sheetExample.png" alt="Google sheet page"/></p>
<p><strong><a href="https://next-shopping-cart.vercel.app">DEMO</a></strong></p>
<p>The previous blog:  <a href="https://zjusticy.github.io/blog/next-react-shopping-cart">next-shopping-cart</a></p>
<p>You can check the code of this project on <a href="https://github.com/zjusticy/next-shopping-cart">Github</a>.</p>
<p>Google Sheets have some great advantage as a content management system.</p>
<ul>
<li>It is easy for people to get started and the cost of learning is extremely low</li>
<li>Build-in collaboration support</li>
</ul>
<p>Cons:</p>
<ul>
<li>There are <a href="https://developers.google.com/sheets/api/limits">usage limits</a> for the Google Sheets API.</li>
<li>It is not a proper database if your business keeps growing. However, it is still capable of connecting Google Sheets with other headless CMSs.</li>
</ul>
<p>Here is an example of using Google Sheets for an eCommerce site.</p>
<p><a href="https://docs.google.com/spreadsheets/d/1UsOkG1kRY6Qb50F76v-msb18-mvXxvX-0CmcAtv_aoA/edit?usp=sharing">Google Sheets Example</a></p>
<p>For a small site, it is easy to maintain and update by using Google Sheets. Also, we can use Google App Script to select the data and output it to other platforms. In Google App Script, we have to first implement a <strong>doGet()</strong> function as a response to an HTTP get request. From the sheets’ URL and page name, we can reach the data we need. The code below can explain itself.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span>  <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span>  <span class="token constant">SPREADSHEET_URL</span> <span class="token operator">=</span> <span class="token string">&quot;Google Sheets&#x27; URL&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span>  <span class="token constant">SHEET_NAME_ONE</span> <span class="token operator">=</span> <span class="token string">&quot;Sheets&#x27; name&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">// Get the sheets by name</span>
  <span class="token keyword">var</span>  ss <span class="token operator">=</span> <span class="token maybe-class-name">SpreadsheetApp</span><span class="token punctuation">.</span><span class="token method function property-access">openByUrl</span><span class="token punctuation">(</span><span class="token constant">SPREADSHEET_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Get the certain sheet by name</span>
  <span class="token keyword">var</span>  sheet <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token method function property-access">getSheetByName</span><span class="token punctuation">(</span><span class="token constant">SHEET_NAME_ONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span>  jo <span class="token operator">=</span> <span class="token function">getItems</span><span class="token punctuation">(</span>sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Stringify and output the data</span>
  <span class="token keyword">var</span>  result <span class="token operator">=</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>jo<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span>  <span class="token maybe-class-name">ContentService</span><span class="token punctuation">.</span><span class="token method function property-access">createTextOutput</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">setMimeType</span><span class="token punctuation">(</span><span class="token maybe-class-name">ContentService</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">MimeType</span></span><span class="token punctuation">.</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span>  <span class="token function">getItems</span><span class="token punctuation">(</span><span class="token parameter">sheet</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span>  dataArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Collect data from the 2nd row to the last row vertically,</span>
<span class="token comment">// and from the first column to the last column horizontally for each row</span>
  <span class="token keyword">var</span>  rows <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getLastColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">getValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// For the equation use getFormulas instead of getValues</span>
  <span class="token keyword">var</span>  urls <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">getFormulas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Go through all the rows to put data into an array</span>

  <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span>  i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> rows<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>j<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span>  dataRow <span class="token operator">=</span> rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span>  record <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    record<span class="token punctuation">[</span><span class="token string">&#x27;id&#x27;</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRow<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    record<span class="token punctuation">[</span><span class="token string">&#x27;name&#x27;</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRow<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    record<span class="token punctuation">[</span><span class="token string">&#x27;unit&#x27;</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRow<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    record<span class="token punctuation">[</span><span class="token string">&#x27;price&#x27;</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRow<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Extract the URL data using regular expression</span>
    record<span class="token punctuation">[</span><span class="token string">&#x27;image&#x27;</span><span class="token punctuation">]</span> <span class="token operator">=</span> urls<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">=image\(&quot;(.*)&quot;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    record<span class="token punctuation">[</span><span class="token string">&#x27;categary&#x27;</span><span class="token punctuation">]</span> <span class="token operator">=</span> dataRow<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    dataArray<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword control-flow">return</span>  dataArray<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Then save the file --&gt; click deploy --&gt; new deploy --&gt; select type ( web application) --&gt; select anyone can access the application --&gt; deploy. We can check the result from an API testing tool online.</p>
<p><img src="/apiTest.png" alt="Screen Shot 2021-02-16 at 10.00.37 PM"/></p>
<p>This is really useful for some showcase websites.</p>
<h2>Reference</h2>
<p><a href="https://medium.com/%E9%87%8E%E8%96%91%E9%96%8B%E6%A5%AD%E6%97%A5%E8%A8%98/%E9%81%8B%E7%94%A8-google-sheet-%E8%A3%BD%E4%BD%9C%E7%B0%A1%E6%98%93%E7%9A%84-cms-b5b2a99b101e">Simple site from Goole Sheets</a></p></div></div></article><div class="marginTop-2"><a>← Blog</a></div></div></main><footer class="layout_myFooter__JubIR container"><div class="layout_footerStyle__2iYeS"><div><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg>  <a href="mailto:tzhu618@gmail.com">tzhu618@gmail.com</a></div><div class="layout_lastColor__ALfcM">© <!-- -->2021<!-- -->, Built with<!-- --> <a href="https://nextjs.org/">NextJs</a> and <a href="https://bulma.io">Bulma</a></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Use google sheets as a content management system (CMS) for an eCommerce site","date":"2021-02-10T09:40:32.169Z","description":"Use google sheets as a content management system (CMS) for an eCommerce site","slug":"sheet-to-site","content":"\n![Google sheet page](/sheetExample.png)\n\n\n**[DEMO](https://next-shopping-cart.vercel.app)**\n\nThe previous blog:  [next-shopping-cart](https://zjusticy.github.io/blog/next-react-shopping-cart)\n\nYou can check the code of this project on [Github](https://github.com/zjusticy/next-shopping-cart).\n\n\n\nGoogle Sheets have some great advantage as a content management system.\n\n- It is easy for people to get started and the cost of learning is extremely low\n- Build-in collaboration support\n\nCons:\n\n- There are [usage limits](https://developers.google.com/sheets/api/limits) for the Google Sheets API. \n- It is not a proper database if your business keeps growing. However, it is still capable of connecting Google Sheets with other headless CMSs.\n\nHere is an example of using Google Sheets for an eCommerce site. \n\n[Google Sheets Example](https://docs.google.com/spreadsheets/d/1UsOkG1kRY6Qb50F76v-msb18-mvXxvX-0CmcAtv_aoA/edit?usp=sharing)\n\nFor a small site, it is easy to maintain and update by using Google Sheets. Also, we can use Google App Script to select the data and output it to other platforms. In Google App Script, we have to first implement a **doGet()** function as a response to an HTTP get request. From the sheets’ URL and page name, we can reach the data we need. The code below can explain itself.\n\n\n```js\nfunction  doGet(e) {\n  var  SPREADSHEET_URL = \"Google Sheets' URL\";\n  var  SHEET_NAME_ONE = \"Sheets' name\";\n\n  // Get the sheets by name\n  var  ss = SpreadsheetApp.openByUrl(SPREADSHEET_URL);\n  // Get the certain sheet by name\n  var  sheet = ss.getSheetByName(SHEET_NAME_ONE);\n  var  jo = getItems(sheet);\n\n  // Stringify and output the data\n  var  result = JSON.stringify(jo);\n  return  ContentService.createTextOutput(result).setMimeType(ContentService.MimeType.JSON);\n}\n\nfunction  getItems(sheet) {\n  var  dataArray = [];\n\n// Collect data from the 2nd row to the last row vertically,\n// and from the first column to the last column horizontally for each row\n  var  rows = sheet.getRange(2, 1, sheet.getLastRow() - 1, sheet.getLastColumn()).getValues();\n\n// For the equation use getFormulas instead of getValues\n  var  urls = sheet.getRange(2, 5, sheet.getLastRow() - 1, 1).getFormulas();\n\n// Go through all the rows to put data into an array\n\n  for (var  i=0, j = rows.length; i\u003cj; i++) {\n    var  dataRow = rows[i];\n    var  record = {};\n\n    record['id'] = dataRow[0].toString();\n    record['name'] = dataRow[1];\n    record['unit'] = dataRow[2];\n    record['price'] = dataRow[3].toString();\n    // Extract the URL data using regular expression\n    record['image'] = urls[i][0].match(/=image\\(\"(.*)\"/i)[1];\n    record['categary'] = dataRow[5];\n\n    dataArray.push(record);\n  }\n\n  return  dataArray;\n}\n```\n\n\nThen save the file --\u003e click deploy --\u003e new deploy --\u003e select type ( web application) --\u003e select anyone can access the application --\u003e deploy. We can check the result from an API testing tool online.\n\n![Screen Shot 2021-02-16 at 10.00.37 PM](/apiTest.png)\n\nThis is really useful for some showcase websites.\n\n\n\n## Reference\n\n[Simple site from Goole Sheets](https://medium.com/野薑開業日記/運用-google-sheet-製作簡易的-cms-b5b2a99b101e)"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"sheet-to-site"},"buildId":"OyX9zXWnaKsF3bwITkPiy","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/runtime/polyfills-81f5c03661bad3d2f6ee.js"></script><script async="" data-next-page="/_app" src="/_next/static/OyX9zXWnaKsF3bwITkPiy/pages/_app.js"></script><script async="" data-next-page="/blog/[slug]" src="/_next/static/OyX9zXWnaKsF3bwITkPiy/pages/blog/%5Bslug%5D.js"></script><script src="/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="/_next/static/chunks/framework.126679bf45d7d49475d8.js" async=""></script><script src="/_next/static/chunks/commons.034e57c59893763d3595.js" async=""></script><script src="/_next/static/runtime/main-d7ebbd1d8dc934d86683.js" async=""></script><script src="/_next/static/chunks/cb1608f2.3c307e8bab2014a7f3fb.js" async=""></script><script src="/_next/static/chunks/b5f2ed29.a17aa8175ac69602f508.js" async=""></script><script src="/_next/static/chunks/02a29bc1c6847a2903810fa698c0853380643ebd.eb7f86bcbbf58571f3fc.js" async=""></script><script src="/_next/static/chunks/411cb42639decf701111c98274b23dedc6e87d14.7504d1c9a7d74be7afa0.js" async=""></script><script src="/_next/static/OyX9zXWnaKsF3bwITkPiy/_buildManifest.js" async=""></script><script src="/_next/static/OyX9zXWnaKsF3bwITkPiy/_ssgManifest.js" async=""></script></body></html>
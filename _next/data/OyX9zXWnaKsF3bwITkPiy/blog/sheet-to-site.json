{"pageProps":{"post":{"title":"Use google sheets as a content management system (CMS) for an eCommerce site","date":"2021-02-10T09:40:32.169Z","description":"Use google sheets as a content management system (CMS) for an eCommerce site","slug":"sheet-to-site","content":"\n![Google sheet page](/sheetExample.png)\n\n\n**[DEMO](https://next-shopping-cart.vercel.app)**\n\nThe previous blog:  [next-shopping-cart](https://zjusticy.github.io/blog/next-react-shopping-cart)\n\nYou can check the code of this project on [Github](https://github.com/zjusticy/next-shopping-cart).\n\n\n\nGoogle Sheets have some great advantage as a content management system.\n\n- It is easy for people to get started and the cost of learning is extremely low\n- Build-in collaboration support\n\nCons:\n\n- There are [usage limits](https://developers.google.com/sheets/api/limits) for the Google Sheets API. \n- It is not a proper database if your business keeps growing. However, it is still capable of connecting Google Sheets with other headless CMSs.\n\nHere is an example of using Google Sheets for an eCommerce site. \n\n[Google Sheets Example](https://docs.google.com/spreadsheets/d/1UsOkG1kRY6Qb50F76v-msb18-mvXxvX-0CmcAtv_aoA/edit?usp=sharing)\n\nFor a small site, it is easy to maintain and update by using Google Sheets. Also, we can use Google App Script to select the data and output it to other platforms. In Google App Script, we have to first implement a **doGet()** function as a response to an HTTP get request. From the sheets’ URL and page name, we can reach the data we need. The code below can explain itself.\n\n\n```js\nfunction  doGet(e) {\n  var  SPREADSHEET_URL = \"Google Sheets' URL\";\n  var  SHEET_NAME_ONE = \"Sheets' name\";\n\n  // Get the sheets by name\n  var  ss = SpreadsheetApp.openByUrl(SPREADSHEET_URL);\n  // Get the certain sheet by name\n  var  sheet = ss.getSheetByName(SHEET_NAME_ONE);\n  var  jo = getItems(sheet);\n\n  // Stringify and output the data\n  var  result = JSON.stringify(jo);\n  return  ContentService.createTextOutput(result).setMimeType(ContentService.MimeType.JSON);\n}\n\nfunction  getItems(sheet) {\n  var  dataArray = [];\n\n// Collect data from the 2nd row to the last row vertically,\n// and from the first column to the last column horizontally for each row\n  var  rows = sheet.getRange(2, 1, sheet.getLastRow() - 1, sheet.getLastColumn()).getValues();\n\n// For the equation use getFormulas instead of getValues\n  var  urls = sheet.getRange(2, 5, sheet.getLastRow() - 1, 1).getFormulas();\n\n// Go through all the rows to put data into an array\n\n  for (var  i=0, j = rows.length; i<j; i++) {\n    var  dataRow = rows[i];\n    var  record = {};\n\n    record['id'] = dataRow[0].toString();\n    record['name'] = dataRow[1];\n    record['unit'] = dataRow[2];\n    record['price'] = dataRow[3].toString();\n    // Extract the URL data using regular expression\n    record['image'] = urls[i][0].match(/=image\\(\"(.*)\"/i)[1];\n    record['categary'] = dataRow[5];\n\n    dataArray.push(record);\n  }\n\n  return  dataArray;\n}\n```\n\n\nThen save the file --> click deploy --> new deploy --> select type ( web application) --> select anyone can access the application --> deploy. We can check the result from an API testing tool online.\n\n![Screen Shot 2021-02-16 at 10.00.37 PM](/apiTest.png)\n\nThis is really useful for some showcase websites.\n\n\n\n## Reference\n\n[Simple site from Goole Sheets](https://medium.com/野薑開業日記/運用-google-sheet-製作簡易的-cms-b5b2a99b101e)"}},"__N_SSG":true}
{"pageProps":{"title":"Use google sheets as a content management system (CMS) for an eCommerce site","date":"2021-02-10T09:40:32.169Z","description":"Use google sheets as a content management system (CMS) for an eCommerce site","slug":"sheet-to-site","content":"<p><img src=\"/sheetExample.png\" alt=\"Google sheet page\"></p>\n<p><strong><a href=\"https://next-shopping-cart.vercel.app\">DEMO</a></strong></p>\n<p>The previous blog:  <a href=\"https://zjusticy.github.io/blog/next-react-shopping-cart\">next-shopping-cart</a></p>\n<p>You can check the code of this project on <a href=\"https://github.com/zjusticy/next-shopping-cart\">Github</a>.</p>\n<p>Google Sheets have some great advantage as a content management system.</p>\n<ul>\n<li>It is easy for people to get started and the cost of learning is extremely low</li>\n<li>Build-in collaboration support</li>\n</ul>\n<p>Cons:</p>\n<ul>\n<li>There are <a href=\"https://developers.google.com/sheets/api/limits\">usage limits</a> for the Google Sheets API.</li>\n<li>It is not a proper database if your business keeps growing. However, it is still capable of connecting Google Sheets with other headless CMSs.</li>\n</ul>\n<p>Here is an example of using Google Sheets for an eCommerce site.</p>\n<p><a href=\"https://docs.google.com/spreadsheets/d/1UsOkG1kRY6Qb50F76v-msb18-mvXxvX-0CmcAtv_aoA/edit?usp=sharing\">Google Sheets Example</a></p>\n<p>For a small site, it is easy to maintain and update by using Google Sheets. Also, we can use Google App Script to select the data and output it to other platforms. In Google App Script, we have to first implement a <strong>doGet()</strong> function as a response to an HTTP get request. From the sheetsâ€™ URL and page name, we can reach the data we need. The code below can explain itself.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span>  <span class=\"token function\">doGet</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span>  <span class=\"token constant\">SPREADSHEET_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Google Sheets' URL\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span>  <span class=\"token constant\">SHEET_NAME_ONE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Sheets' name\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Get the sheets by name</span>\n  <span class=\"token keyword\">var</span>  ss <span class=\"token operator\">=</span> <span class=\"token maybe-class-name\">SpreadsheetApp</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">openByUrl</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SPREADSHEET_URL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Get the certain sheet by name</span>\n  <span class=\"token keyword\">var</span>  sheet <span class=\"token operator\">=</span> ss<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SHEET_NAME_ONE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span>  jo <span class=\"token operator\">=</span> <span class=\"token function\">getItems</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Stringify and output the data</span>\n  <span class=\"token keyword\">var</span>  result <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">stringify</span><span class=\"token punctuation\">(</span>jo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">return</span>  <span class=\"token maybe-class-name\">ContentService</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">createTextOutput</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">setMimeType</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">ContentService</span><span class=\"token punctuation\">.</span><span class=\"token property-access\"><span class=\"token maybe-class-name\">MimeType</span></span><span class=\"token punctuation\">.</span><span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span>  <span class=\"token function\">getItems</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sheet</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span>  dataArray <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Collect data from the 2nd row to the last row vertically,</span>\n<span class=\"token comment\">// and from the first column to the last column horizontally for each row</span>\n  <span class=\"token keyword\">var</span>  rows <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> sheet<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getLastRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> sheet<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getLastColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// For the equation use getFormulas instead of getValues</span>\n  <span class=\"token keyword\">var</span>  urls <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getRange</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> sheet<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getLastRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getFormulas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Go through all the rows to put data into an array</span>\n\n  <span class=\"token keyword control-flow\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span>  i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> j <span class=\"token operator\">=</span> rows<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&#x3C;</span>j<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span>  dataRow <span class=\"token operator\">=</span> rows<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span>  record <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    record<span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> dataRow<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    record<span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> dataRow<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    record<span class=\"token punctuation\">[</span><span class=\"token string\">'unit'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> dataRow<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    record<span class=\"token punctuation\">[</span><span class=\"token string\">'price'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> dataRow<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Extract the URL data using regular expression</span>\n    record<span class=\"token punctuation\">[</span><span class=\"token string\">'image'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> urls<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">=image\\(\"(.*)\"</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">i</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    record<span class=\"token punctuation\">[</span><span class=\"token string\">'categary'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> dataRow<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n    dataArray<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword control-flow\">return</span>  dataArray<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>Then save the file --> click deploy --> new deploy --> select type ( web application) --> select anyone can access the application --> deploy. We can check the result from an API testing tool online.</p>\n<p><img src=\"/apiTest.png\" alt=\"Screen Shot 2021-02-16 at 10.00.37 PM\"></p>\n<p>This is really useful for some showcase websites.</p>\n<h2>Reference</h2>\n<p><a href=\"https://medium.com/%E9%87%8E%E8%96%91%E9%96%8B%E6%A5%AD%E6%97%A5%E8%A8%98/%E9%81%8B%E7%94%A8-google-sheet-%E8%A3%BD%E4%BD%9C%E7%B0%A1%E6%98%93%E7%9A%84-cms-b5b2a99b101e\">Simple site from Goole Sheets</a></p>"},"__N_SSG":true}